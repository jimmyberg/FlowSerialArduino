
#ifndef flowSerial_h
#define flowSerial_h

#include "Arduino.h"

class FlowSerial{
  public:
    FlowSerial(int baudrate, int regSize, char IDinit);
    void update();
    char ID;
    unsigned char serialReg[256];
    char inboxBuffer[256];
    boolean debugEnable;
    char read();
    int available();
    void write(byte address, byte out[], int quantity);
    void write(byte address, byte out)
  private:
    unsigned char inboxRegisterAt;
    unsigned char inboxAvailable;
    unsigned char process;
    unsigned char argumentBuffer[256];
    unsigned char argumentBufferAt;
    long timeoutTime;
    int LSBchecksumIn;
    int MSBchecksumIn;
    int checksumInbox;
    int instruction;
    void sendID();
    void readCommand();
    void writeCommand();
    void recieveData();
    void transmissionError(boolean resend);
    void sendDebugInfo(String text, int textLenght);
};

#endif
